const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TinderStack-BHmP1hRr.js","assets/framer-motion-B4_CJGXS.js","assets/button-CCKa5jUo.js","assets/radix-ui-DTUURzEd.js","assets/firebase-CKBzFk3f.js","assets/ui-utils-BxIQ3qGg.js","assets/PageHeader-Lihv4X5P.js","assets/map-pin-B0u_CyAy.js","assets/index-CxtCZa1v.js","assets/index-B2LVqTOM.css","assets/x-B7Ayx_S2.js","assets/EmptyState-DXYLOXNh.js"])))=>i.map(i=>d[i]);
import{c as I,d as p,a as y,u as R,U as q,_ as H}from"./index-CxtCZa1v.js";import{j as e,r as g}from"./framer-motion-B4_CJGXS.js";import{P as F}from"./PageHeader-Lihv4X5P.js";import{E as C}from"./EmptyState-DXYLOXNh.js";import{C as D,a as L,b as P,c as E}from"./button-CCKa5jUo.js";import{A as $,a as _,u as V}from"./useConnections-xNm_MLxY.js";import{C as G}from"./check-D4YSFbia.js";import{h as S,f as A,d as w,s as M,e as z}from"./firebase-CKBzFk3f.js";import"./radix-ui-DTUURzEd.js";import"./ui-utils-BxIQ3qGg.js";/**
 * @license lucide-react v0.408.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=I("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);function O({connections:a,selected:h,onSelectionChange:x,compact:t=!1}){if(a.length===0)return e.jsxs(D,{className:"bg-muted/50",children:[e.jsx(L,{children:e.jsx(P,{className:"text-xl",children:"Selecciona tu Compañero"})}),e.jsx(E,{children:e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Aún no tienes conexiones. ¡Agrega amigos para empezar a planificar juntos!"})})]});if(t&&h){const s=a.find(u=>u.uid===h);if(s)return e.jsx(D,{className:"bg-muted/50",children:e.jsx(E,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($,{className:"w-10 h-10 ring-2 ring-background",children:e.jsx(_,{className:"bg-gradient-to-br from-purple-400 to-pink-400 text-white text-sm font-semibold",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Planificando con ",s.name]}),s.relation&&e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.relation})]})]}),e.jsx("button",{onClick:()=>x(""),className:"text-sm text-brand-primary hover:text-brand-primary/80 font-medium",children:"Cambiar"})]})})})}return e.jsxs(D,{className:"bg-muted/50",children:[e.jsx(L,{children:e.jsx(P,{className:"text-xl",children:"Selecciona tu Compañero"})}),e.jsx(E,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4",children:a.map(s=>e.jsxs("button",{onClick:()=>x(s.uid),className:`
                relative p-3 rounded-lg border-2 transition-all duration-200 hover:scale-105
                ${h===s.uid?"border-brand-primary bg-brand-primary/10 shadow-lg":"border-border hover:border-brand-primary/50 bg-background"}
              `,children:[h===s.uid&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-brand-primary rounded-full flex items-center justify-center shadow-lg",children:e.jsx(G,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx($,{className:"w-12 h-12 ring-2 ring-background",children:e.jsx(_,{className:"bg-gradient-to-br from-purple-400 to-pink-400 text-white text-lg font-semibold",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium truncate max-w-[80px]",children:s.name}),s.relation&&e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.relation})]})]})]},s.uid))})})]})}function B(a=!1){const[h,x]=g.useState([]),[t,s]=g.useState(!0),[u,f]=g.useState(null),j=async()=>{try{s(!0),f(null);const r=await S(A(p,"dates")),c=Date.now();let i=r.docs.map(o=>({id:o.id,...o.data()})).filter(o=>{const m=o.active&&(!o.expiresAt||new Date(o.expiresAt).getTime()>c),d=a?!0:o.relationType==="solo";return m&&d});if(a&&y.currentUser){const o=y.currentUser.uid,d=(await S(A(p,"likes"))).docs.map(n=>n.data()).filter(n=>n.userId===o).map(n=>n.dateId),v=(await S(A(p,"matches"))).docs.map(n=>n.data()).filter(n=>n.users.includes(o)).map(n=>n.dateId),k=[...new Set([...d,...v])];i=i.filter(n=>!k.includes(n.id))}x(i)}catch(r){console.error("Error al cargar planes:",r),f("Error al cargar planes")}finally{s(!1)}};return g.useEffect(()=>{j()},[a]),{dates:h,loading:t,error:u,likeDate:async(r,c)=>{const l=y.currentUser;if(!l)throw new Error("Usuario no autenticado");try{const i=`${l.uid}_${r}`,o=w(p,"likes",i);await M(o,{userId:l.uid,dateId:r,liked:!0,createdAt:Date.now()},{merge:!0});try{const m=`${c}_${r}`,d=w(p,"likes",m);if((await z(d)).exists()){const v=`${[l.uid,c].sort().join("_")}_${r}`,k=w(p,"matches",v);try{return(await z(k)).exists()?{hasMatch:!0,isNewMatch:!1}:(await M(k,{users:[l.uid,c],dateId:r,createdAt:Date.now(),plannedFor:"",status:"pending"},{merge:!0}),{hasMatch:!0,isNewMatch:!0})}catch(n){return console.error("Error creando match:",n),{hasMatch:!1,isNewMatch:!1}}}return{hasMatch:!1,isNewMatch:!1}}catch(m){return console.error("Error verificando likes de otros usuarios:",m),{hasMatch:!1,isNewMatch:!1}}}catch(i){throw console.error("Error al dar like:",i),new Error(`Error al procesar el like: ${i instanceof Error?i.message:"Error desconocido"}`)}},dislikeDate:async r=>{const c=y.currentUser;if(!c)throw new Error("Usuario no autenticado");try{const l=`${c.uid}_${r}`,i=w(p,"likes",l);return await M(i,{userId:c.uid,dateId:r,liked:!1,createdAt:Date.now()},{merge:!0}),{success:!0}}catch(l){throw console.error("Error al dar dislike:",l),new Error(`Error al procesar el dislike: ${l instanceof Error?l.message:"Error desconocido"}`)}},refreshDates:j}}function J(){const[a,h]=g.useState(""),[x,t]=g.useState(null),{user:s}=R(),u=!!s,{dates:f,loading:j,likeDate:b,dislikeDate:N,refreshDates:r}=B(u),{connections:c,loading:l}=V();return{selected:a,setSelected:h,likingDateId:x,user:s,isLogged:u,dates:f,connections:c,loading:j||l,handleLikeDate:async m=>{if(!a)return{hasMatch:!1,isNewMatch:!1};try{t(m);const d=await b(m,a);return console.log(d.hasMatch?"Match creado! 🎉":"Plan guardado! ✨"),d.hasMatch&&setTimeout(()=>r(),1e3),d}catch(d){throw console.error("Error al procesar el like:",d),d}finally{t(null)}},handlePassDate:async m=>{try{await N(m),console.log("Plan marcado como no interesante")}catch(d){console.error("Error al marcar como no interesante:",d)}}}}const K=g.lazy(()=>H(()=>import("./TinderStack-BHmP1hRr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])).then(a=>({default:a.TinderStack}))),Q=()=>e.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 dark:bg-gray-800 rounded-xl",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Cargando planes..."})]})});function ne(){var b,N,r,c,l,i;const{selected:a,setSelected:h,isLogged:x,dates:t,connections:s,loading:u,handleLikeDate:f,handlePassDate:j}=J();return u?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-muted rounded w-2/3"})]})}):e.jsxs("div",{className:`pb-20 ${a?"space-y-4":"space-y-8"}`,children:[!x||s.length===0||a===""?e.jsx(F,{title:"Encuentra tu Plan",description:"Descubre actividades perfectas para compartir",icon:e.jsx(T,{className:"w-8 h-8 md:w-10 md:h-10 text-white"}),badge:{text:`${t.length} planes disponibles`,className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white"}}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Planes para ti"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.length," planes disponibles"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{children:"¡Desliza para explorar!"})]})]}),x&&s.length===0?e.jsx(C,{icon:e.jsx(q,{className:"w-8 h-8 text-muted-foreground"}),title:"¡Conecta con Amigos!",description:"Aún no tienes conexiones. Agrega amigos con su PIN para encontrar planes increíbles juntos.",tip:"Ve a la sección Amigos para conectarte"}):e.jsxs("div",{className:`${a?"space-y-4":"space-y-8"}`,children:[x&&s.length>0&&e.jsx(O,{connections:s,selected:a,onSelectionChange:h,compact:a!==""}),x&&s.length>0&&a===""?e.jsx(C,{icon:e.jsx("span",{className:"text-2xl",children:"👆"}),title:"Selecciona un compañero",description:"Elige una conexión arriba para ver planes increíbles que pueden hacer juntos."}):e.jsxs("div",{className:"flex flex-col lg:flex-row lg:h-[700px] gap-6",children:[e.jsx("div",{className:"flex-1 lg:w-1/2 flex justify-center items-center",children:e.jsx(g.Suspense,{fallback:e.jsx(Q,{}),children:e.jsx(K,{dates:t,onLike:f,onPass:j})})}),a&&e.jsxs("div",{className:"flex-1 lg:w-1/2 space-y-6 lg:space-y-6",children:[t.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 lg:p-6 shadow-lg border",children:[e.jsx("h3",{className:"text-lg lg:text-xl font-bold mb-3 lg:mb-4 text-gray-900 dark:text-white",children:"Plan Actual"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-base lg:text-lg text-gray-800 dark:text-gray-200",children:(b=t[0])==null?void 0:b.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:(N=t[0])==null?void 0:N.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Duración"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white text-sm lg:text-base",children:(r=t[0])==null?void 0:r.duration})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Costo"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white text-sm lg:text-base",children:(c=t[0])==null?void 0:c.cost})]})]}),((l=t[0])==null?void 0:l.city)&&e.jsxs("div",{className:"pt-2",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Ubicación"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white text-sm lg:text-base",children:(i=t[0])==null?void 0:i.city})]})]})]}),e.jsxs("div",{className:"lg:space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl p-4 lg:p-6 border",children:[e.jsx("h3",{className:"text-lg lg:text-xl font-bold mb-3 lg:mb-4 text-gray-900 dark:text-white",children:"Tu Progreso"}),e.jsxs("div",{className:"space-y-3 lg:space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400 text-sm lg:text-base",children:"Planes disponibles"}),e.jsx("span",{className:"font-bold text-xl lg:text-2xl text-purple-600 dark:text-purple-400",children:t.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400 text-sm lg:text-base",children:"Compañero"}),e.jsx("span",{className:"text-green-600 dark:text-green-400 font-semibold text-sm lg:text-base",children:"✓ Seleccionado"})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Listo para explorar planes"})]})})]})]}),e.jsxs("div",{className:"hidden lg:block bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"💡 Cómo Funciona"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 dark:text-green-400 text-sm font-bold",children:"→"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Me Gusta"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Desliza derecha o usa el botón ❤️"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-red-600 dark:text-red-400 text-sm font-bold",children:"←"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Pasar"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Desliza izquierda o usa el botón ✗"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 dark:text-blue-400 text-sm font-bold",children:"🎯"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Match"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Si ambos dan me gusta, ¡crean un plan!"})]})]})]})]}),e.jsxs("div",{className:"hidden lg:block bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-xl p-6 border",children:[e.jsx("h3",{className:"text-xl font-bold mb-3 text-gray-900 dark:text-white",children:"✨ Consejo del Día"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:"¡Sé aventurero! A veces los mejores recuerdos vienen de planes que no esperabas que te gustaran."})]})]})]})]})]})]})}export{ne as default};

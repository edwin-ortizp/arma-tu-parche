const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TinderStack-V81LGdgY.js","assets/framer-motion-B4_CJGXS.js","assets/card-BmR1zu1U.js","assets/index-BjUTfRdL.js","assets/radix-ui-C_8bfTb2.js","assets/firebase-CKBzFk3f.js","assets/ui-utils-B2rm_Apj.js","assets/index-DnpvWf-R.css","assets/PageHeader-UUcHsewb.js","assets/x-BjgGufs2.js","assets/EmptyState-D1LSKJrB.js"])))=>i.map(i=>d[i]);
import{c as H,d as N,a as D,u as q,U as R,_ as F}from"./index-BjUTfRdL.js";import{j as e,r as g}from"./framer-motion-B4_CJGXS.js";import{P as V}from"./PageHeader-UUcHsewb.js";import{E as P,C as $,M as T}from"./EmptyState-D1LSKJrB.js";import{C as G,a as O,b as B,c as J}from"./card-BmR1zu1U.js";import{A as _,a as I,u as K}from"./useConnections-8M63Dqmq.js";import{C as Q}from"./check-Db9uXkjR.js";import{h as M,f as C,d as E,s as S,e as U}from"./firebase-CKBzFk3f.js";import"./radix-ui-C_8bfTb2.js";import"./ui-utils-B2rm_Apj.js";/**
 * @license lucide-react v0.408.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=H("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.408.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=H("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);function X({connections:t,selected:h,onSelectionChange:x,compact:s=!1}){const p=[{uid:"solo",name:"Solo",relation:"solo"},...t];if(s&&h){const r=p.find(f=>f.uid===h);if(r)return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"w-8 h-8",children:e.jsx(I,{className:`text-white text-xs font-semibold ${r.uid==="solo"?"bg-gradient-to-br from-gray-400 to-slate-500":"bg-gradient-to-br from-blue-400 to-cyan-500"}`,children:r.name.charAt(0).toUpperCase()})}),e.jsx("div",{children:e.jsx("p",{className:"font-medium text-sm",children:r.uid==="solo"?"Planes para mí":`Con ${r.name}`})})]}),e.jsx("button",{onClick:()=>x(""),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Cambiar"})]})}return e.jsxs(G,{className:"bg-muted/50 w-full",children:[e.jsx(O,{className:"pb-3",children:e.jsx(B,{className:"text-lg",children:"¿Con quién planeas?"})}),e.jsx(J,{children:e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-4 md:grid-cols-5",children:p.map(r=>e.jsxs("button",{onClick:()=>x(r.uid),className:`
                relative p-3 rounded-lg border-2 transition-all duration-200 hover:scale-105
                ${h===r.uid?"border-brand-primary bg-brand-primary/10 shadow-lg":"border-border hover:border-brand-primary/50 bg-background"}
              `,children:[h===r.uid&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-brand-primary rounded-full flex items-center justify-center shadow-lg",children:e.jsx(Q,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(_,{className:"w-10 h-10",children:e.jsx(I,{className:`text-white text-sm font-semibold ${r.uid==="solo"?"bg-gradient-to-br from-gray-400 to-slate-500":"bg-gradient-to-br from-blue-400 to-cyan-500"}`,children:r.name.charAt(0).toUpperCase()})}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xs font-medium truncate max-w-[60px]",children:r.name})})]})]},r.uid))})})]})}function Y(t=!1){const[h,x]=g.useState([]),[s,m]=g.useState(!0),[p,r]=g.useState(null),f=async()=>{try{m(!0),r(null);const l=await M(C(N,"dates")),o=Date.now();let c=l.docs.map(a=>({id:a.id,...a.data()})).filter(a=>{const d=a.active&&(!a.expiresAt||new Date(a.expiresAt).getTime()>o),u=t?!0:a.relationType==="solo";return d&&u});if(t&&D.currentUser){const a=D.currentUser.uid,u=(await M(C(N,"likes"))).docs.map(i=>i.data()).filter(i=>i.userId===a).map(i=>i.dateId),b=(await M(C(N,"matches"))).docs.map(i=>i.data()).filter(i=>i.users.includes(a)).map(i=>i.dateId),y=[...new Set([...u,...b])];c=c.filter(i=>!y.includes(i.id))}const j=c.sort(()=>Math.random()-.5);x(j)}catch(l){console.error("Error al cargar planes:",l),r("Error al cargar planes")}finally{m(!1)}};return g.useEffect(()=>{f()},[t]),{dates:h,loading:s,error:p,likeDate:async(l,o)=>{const n=D.currentUser;if(!n)throw new Error("Usuario no autenticado");try{const c=`${n.uid}_${l}`,j=E(N,"likes",c);await S(j,{userId:n.uid,dateId:l,liked:!0,createdAt:Date.now()},{merge:!0});try{const a=`${o}_${l}`,d=E(N,"likes",a);if((await U(d)).exists()){const k=`${[n.uid,o].sort().join("_")}_${l}`,b=E(N,"matches",k);try{return(await U(b)).exists()?{hasMatch:!0,isNewMatch:!1}:(await S(b,{users:[n.uid,o],dateId:l,createdAt:Date.now(),plannedFor:"",status:"pending"},{merge:!0}),{hasMatch:!0,isNewMatch:!0})}catch(y){return console.error("Error creando match:",y),{hasMatch:!1,isNewMatch:!1}}}return{hasMatch:!1,isNewMatch:!1}}catch(a){return console.error("Error verificando likes de otros usuarios:",a),{hasMatch:!1,isNewMatch:!1}}}catch(c){throw console.error("Error al dar like:",c),new Error(`Error al procesar el like: ${c instanceof Error?c.message:"Error desconocido"}`)}},dislikeDate:async l=>{const o=D.currentUser;if(!o)throw new Error("Usuario no autenticado");try{const n=`${o.uid}_${l}`,c=E(N,"likes",n);return await S(c,{userId:o.uid,dateId:l,liked:!1,createdAt:Date.now()},{merge:!0}),{success:!0}}catch(n){throw console.error("Error al dar dislike:",n),new Error(`Error al procesar el dislike: ${n instanceof Error?n.message:"Error desconocido"}`)}},refreshDates:f}}function Z(){const[t,h]=g.useState(""),[x,s]=g.useState(null),{user:m}=q(),p=!!m,{dates:r,loading:f,likeDate:w,dislikeDate:v,refreshDates:l}=Y(p),{connections:o,loading:n}=K();return{selected:t,setSelected:h,likingDateId:x,user:m,isLogged:p,dates:r,connections:o,loading:f||n,handleLikeDate:async a=>{if(!t)return{hasMatch:!1,isNewMatch:!1};try{s(a);const d=t==="solo"?(m==null?void 0:m.uid)||"solo":t,u=await w(a,d);return console.log(u.hasMatch?"Match creado! 🎉":"Plan guardado! ✨"),u.hasMatch&&setTimeout(()=>l(),1e3),u}catch(d){throw console.error("Error al procesar el like:",d),d}finally{s(null)}},handlePassDate:async a=>{try{await v(a),console.log("Plan marcado como no interesante")}catch(d){console.error("Error al marcar como no interesante:",d)}}}}const ee=g.lazy(()=>F(()=>import("./TinderStack-V81LGdgY.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])).then(t=>({default:t.TinderStack}))),se=()=>e.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 dark:bg-gray-800 rounded-xl",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Cargando planes..."})]})});function xe(){var w,v,l,o,n,c,j,a,d,u,k,b,y,i,A,L;const{selected:t,setSelected:h,isLogged:x,dates:s,connections:m,loading:p,handleLikeDate:r,handlePassDate:f}=Z();return p?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-muted rounded w-2/3"})]})}):e.jsxs("div",{className:`pb-20 ${t?"space-y-2":"space-y-6"}`,children:[!x||m.length===0||t===""?e.jsx(V,{title:"Encuentra tu Plan",description:"Descubre actividades perfectas para compartir",icon:e.jsx(W,{className:"w-5 h-5 text-white"}),badge:{text:`${s.length} planes disponibles`,className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white"}}):null,x&&m.length===0?e.jsx(P,{icon:e.jsx(R,{className:"w-8 h-8 text-muted-foreground"}),title:"¡Conecta con Amigos!",description:"Aún no tienes conexiones. Agrega amigos con su PIN para encontrar planes increíbles juntos.",tip:"Ve a la sección Amigos para conectarte"}):e.jsxs("div",{className:"flex flex-col h-[calc(100vh-120px)]",children:[x&&e.jsx("div",{className:"flex-shrink-0 px-4 mb-4",children:e.jsx(X,{connections:m,selected:t,onSelectionChange:h,compact:t!==""})}),x&&t===""?e.jsx("div",{className:"px-4",children:e.jsx(P,{icon:e.jsx("span",{className:"text-2xl",children:"👆"}),title:"¿Con quién planeas?",description:"Elige un compañero o selecciona 'Solo' para planes individuales."})}):e.jsxs("div",{className:"flex flex-col lg:flex-row lg:gap-8 h-full",children:[e.jsx("div",{className:"flex-1 flex justify-center items-center px-2 lg:px-0",children:e.jsxs("div",{className:"w-[95vw] lg:w-full lg:max-w-[500px] space-y-4",children:[e.jsx("div",{className:"h-[calc(100vh-300px)] lg:h-[600px] relative",children:e.jsx(g.Suspense,{fallback:e.jsx(se,{}),children:e.jsx(ee,{dates:s,onLike:r,onPass:f})})}),e.jsx("div",{className:"lg:hidden",children:t&&s.length>0&&e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-lg border border-gray-100",children:e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:(w=s[0])==null?void 0:w.category}),e.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[e.jsx($,{className:"w-3 h-3 mr-1"}),(v=s[0])==null?void 0:v.duration]}),e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),(l=s[0])==null?void 0:l.cost]}),((o=s[0])==null?void 0:o.city)&&e.jsxs("span",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),(n=s[0])==null?void 0:n.city]}),((c=s[0])==null?void 0:c.experienceType)&&e.jsx("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium",children:(j=s[0])==null?void 0:j.experienceType})]})})})]})}),e.jsx("div",{className:"hidden lg:block lg:w-80 lg:flex-shrink-0 space-y-6",children:t&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-100",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-900",children:"Detalles del Plan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg text-gray-800 mb-2",children:(a=s[0])==null?void 0:a.title}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:(d=s[0])==null?void 0:d.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:(u=s[0])==null?void 0:u.category}),e.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[e.jsx($,{className:"w-3 h-3 mr-1"}),(k=s[0])==null?void 0:k.duration]}),e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),(b=s[0])==null?void 0:b.cost]}),((y=s[0])==null?void 0:y.city)&&e.jsxs("span",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),(i=s[0])==null?void 0:i.city]}),((A=s[0])==null?void 0:A.experienceType)&&e.jsx("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium",children:(L=s[0])==null?void 0:L.experienceType})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"💡 Cómo usar"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 font-bold",children:"→"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Me Gusta"}),e.jsx("p",{className:"text-gray-600",children:"Desliza derecha o usa el botón ❤️"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-red-600 font-bold",children:"←"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Pasar"}),e.jsx("p",{className:"text-gray-600",children:"Desliza izquierda o usa el botón ✗"})]})]})]})]})]})})]})]}),x&&t&&e.jsx("div",{className:"lg:hidden mt-8 px-6 pb-4",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-100",children:e.jsxs("p",{className:"text-center text-sm text-gray-600",children:["💡 ",e.jsx("strong",{children:"Tip:"})," Desliza → para me gusta, ← para pasar"]})})})]})}export{xe as default};
